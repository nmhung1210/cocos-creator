
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'engine-dev/cocos2d/core/asset-manager/utilities.js';
                    var __require = nodeEnv ? function (request) {
                        return require(request);
                    } : function (request) {
                        return __quick_compile_engine__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_engine__.registerModule(__filename, module);}"use strict";

/****************************************************************************
 Copyright (c) 2019 Xiamen Yaji Software Co., Ltd.

 https://www.cocos.com/

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated engine source code (the "Software"), a limited,
  worldwide, royalty-free, non-assignable, revocable and non-exclusive license
 to use Cocos Creator solely to develop games on your target platforms. You shall
  not use Cocos Creator software for developing other software or tools that's
  used for developing games. You are not granted to publish, distribute,
  sublicense, and/or sell copies of Cocos Creator.

 The software or tools in this License Agreement are licensed, not sold.
 Xiamen Yaji Software Co., Ltd. reserves all rights not expressly granted to you.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
 ****************************************************************************/
var dependUtil = require('./depend-util');

var _require = require('./helper'),
    isScene = _require.isScene,
    decodeUuid = _require.decodeUuid;

var _require2 = require('./shared'),
    assets = _require2.assets;

var _require3 = require('../platform/utils'),
    callInNextTick = _require3.callInNextTick;

var MissingObjectReporter = CC_EDITOR && Editor.require('app://editor/page/scene-utils/missing-object-reporter');

require('../assets/CCAsset');

var utils = {
  processOptions: function processOptions(options) {
    if (CC_EDITOR) return;
    var uuids = options.uuids;
    var paths = options.paths;
    var types = options.types;
    var bundles = options.deps;
    var realEntries = options.paths = Object.create(null);

    if (options.debug === false) {
      for (var i = 0, l = uuids.length; i < l; i++) {
        uuids[i] = decodeUuid(uuids[i]);
      }

      for (var id in paths) {
        var entry = paths[id];
        var type = entry[1];
        entry[1] = types[type];
      }
    } else {
      var out = Object.create(null);

      for (var _i = 0, _l = uuids.length; _i < _l; _i++) {
        var uuid = uuids[_i];
        uuids[_i] = out[uuid] = decodeUuid(uuid);
      }

      uuids = out;
    }

    for (var _id in paths) {
      var _entry = paths[_id];
      realEntries[uuids[_id]] = _entry;
    }

    var scenes = options.scenes;

    for (var name in scenes) {
      var _uuid = scenes[name];
      scenes[name] = uuids[_uuid];
    }

    var packs = options.packs;

    for (var packId in packs) {
      var packedIds = packs[packId];

      for (var j = 0; j < packedIds.length; ++j) {
        packedIds[j] = uuids[packedIds[j]];
      }
    }

    var versions = options.versions;

    if (versions) {
      for (var folder in versions) {
        var entries = versions[folder];

        for (var _i2 = 0; _i2 < entries.length; _i2 += 2) {
          var _uuid2 = entries[_i2];
          entries[_i2] = uuids[_uuid2] || _uuid2;
        }
      }
    }

    var redirect = options.redirect;

    if (redirect) {
      for (var _i3 = 0; _i3 < redirect.length; _i3 += 2) {
        redirect[_i3] = uuids[redirect[_i3]];
        redirect[_i3 + 1] = bundles[redirect[_i3 + 1]];
      }
    }
  },
  clear: function clear(task, clearRef) {
    for (var i = 0, l = task.input.length; i < l; i++) {
      var item = task.input[i];

      if (clearRef) {
        !item.isNative && item.content && item.content.decRef && item.content.decRef(false);
      }

      item.recycle();
    }

    task.input = null;
  },
  urlAppendTimestamp: function urlAppendTimestamp(url) {
    if (cc.assetManager.downloader.appendTimeStamp && typeof url === 'string') {
      if (/\?/.test(url)) return url + '&_t=' + (new Date() - 0);else return url + '?_t=' + (new Date() - 0);
    }

    return url;
  },
  retry: function retry(process, times, wait, onComplete, index) {
    index = index || 0;
    process(index, function (err, result) {
      index++;

      if (!err || index > times) {
        onComplete && onComplete(err, result);
      } else {
        setTimeout(function () {
          utils.retry(process, times, wait, onComplete, index);
        }, wait);
      }
    });
  },
  getDepends: function getDepends(uuid, data, exclude, depends, preload, asyncLoadAssets, config) {
    var err = null;

    try {
      var info = dependUtil.parse(uuid, data);
      var includeNative = true;
      if (data instanceof cc.Asset && (!data.__nativeDepend__ || data._nativeAsset)) includeNative = false;

      if (!preload) {
        asyncLoadAssets = !CC_EDITOR && (!!data.asyncLoadAssets || asyncLoadAssets && !info.preventDeferredLoadDependents);

        for (var i = 0, l = info.deps.length; i < l; i++) {
          var dep = info.deps[i];

          if (!(dep in exclude)) {
            exclude[dep] = true;
            depends.push({
              uuid: dep,
              __asyncLoadAssets__: asyncLoadAssets,
              bundle: config && config.name
            });
          }
        }

        if (includeNative && !asyncLoadAssets && !info.preventPreloadNativeObject && info.nativeDep) {
          config && (info.nativeDep.bundle = config.name);
          depends.push(Object.assign({}, info.nativeDep));
        }
      } else {
        for (var _i4 = 0, _l2 = info.deps.length; _i4 < _l2; _i4++) {
          var _dep = info.deps[_i4];

          if (!(_dep in exclude)) {
            exclude[_dep] = true;
            depends.push({
              uuid: _dep,
              bundle: config && config.name
            });
          }
        }

        if (includeNative && info.nativeDep) {
          config && (info.nativeDep.bundle = config.name);
          depends.push(Object.assign({}, info.nativeDep));
        }
      }
    } catch (e) {
      err = e;
    }

    return err;
  },
  cache: function cache(id, asset, cacheAsset) {
    if (!asset) return;

    var _isScene = isScene(asset);

    if (!_isScene && cacheAsset) {
      assets.add(id, asset);
    }

    if (_isScene) {
      if (CC_EDITOR && !asset.scene) {
        Editor.error('Sorry, the scene data of "%s" is corrupted!', asset._uuid);
      }
    }
  },
  setProperties: function setProperties(uuid, asset, assetsMap) {
    var missingAsset = false;
    var depends = asset.__depends__;

    if (depends) {
      var missingAssetReporter = null;

      for (var i = 0, l = depends.length; i < l; i++) {
        var depend = depends[i];
        var dependAsset = assetsMap[depend.uuid + '@import'];

        if (!dependAsset) {
          if (CC_EDITOR) {
            !missingAssetReporter && (missingAssetReporter = new MissingObjectReporter(asset));
            missingAssetReporter.stashByOwner(depend.owner, depend.prop, Editor.serialize.asAsset(depend.uuid));
          } else {
            cc.error('The asset ' + depend.uuid + ' is missing!');
          }

          missingAsset = true;
        } else {
          depend.owner[depend.prop] = dependAsset.addRef();
        }
      }

      missingAssetReporter && missingAssetReporter.reportByOwner();
      asset.__depends__ = undefined;
    }

    if (asset.__nativeDepend__) {
      if (!asset._nativeAsset) {
        if (assetsMap[uuid + '@native']) {
          asset._nativeAsset = assetsMap[uuid + '@native'];
        } else {
          missingAsset = true;

          if (CC_EDITOR) {
            console.error("the native asset of " + uuid + " is missing!");
          }
        }
      }

      asset.__nativeDepend__ = undefined;
    }

    return missingAsset;
  },
  gatherAsset: function gatherAsset(task) {
    var source = task.source;

    if (!task.options.__outputAsArray__ && source.length === 1) {
      task.output = source[0].content;
    } else {
      var output = task.output = [];

      for (var i = 0, l = source.length; i < l; i++) {
        output.push(source[i].content);
      }
    }
  },
  forEach: function forEach(array, process, onComplete) {
    var count = 0;
    var errs = [];
    if (array.length === 0) onComplete && onComplete(errs);

    for (var i = 0, l = array.length; i < l; i++) {
      process(array[i], function (err) {
        if (err) {
          errs.push(err);
        }

        count++;

        if (count === l) {
          onComplete && onComplete(errs);
        }
      });
    }
  },
  parseParameters: function parseParameters(options, onProgress, onComplete) {
    if (onComplete === undefined) {
      var isCallback = typeof options === 'function';

      if (onProgress) {
        onComplete = onProgress;

        if (!isCallback) {
          onProgress = null;
        }
      } else if (onProgress === undefined && isCallback) {
        onComplete = options;
        options = null;
        onProgress = null;
      }

      if (onProgress !== undefined && isCallback) {
        onProgress = options;
        options = null;
      }
    }

    options = options || Object.create(null);
    return {
      options: options,
      onProgress: onProgress,
      onComplete: onComplete
    };
  },
  parseLoadResArgs: function parseLoadResArgs(type, onProgress, onComplete) {
    if (onComplete === undefined) {
      var isValidType = cc.js.isChildClassOf(type, cc.Asset);

      if (onProgress) {
        onComplete = onProgress;

        if (isValidType) {
          onProgress = null;
        }
      } else if (onProgress === undefined && !isValidType) {
        onComplete = type;
        onProgress = null;
        type = null;
      }

      if (onProgress !== undefined && !isValidType) {
        onProgress = type;
        type = null;
      }
    }

    return {
      type: type,
      onProgress: onProgress,
      onComplete: onComplete
    };
  },
  checkCircleReference: function checkCircleReference(owner, uuid, map, checked) {
    if (!checked) {
      checked = Object.create(null);
    }

    var item = map[uuid];

    if (!item || checked[uuid]) {
      return false;
    }

    checked[uuid] = true;
    var result = false;
    var deps = dependUtil.getDeps(uuid);

    if (deps) {
      for (var i = 0, l = deps.length; i < l; i++) {
        var dep = deps[i];

        if (dep === owner || utils.checkCircleReference(owner, dep, map, checked)) {
          result = true;
          break;
        }
      }
    }

    return result;
  },
  asyncify: function asyncify(cb) {
    return function (p1, p2) {
      cb && callInNextTick(cb, p1, p2);
    };
  }
};
module.exports = utils;
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_engine__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVuZ2luZS1kZXYvY29jb3MyZC9jb3JlL2Fzc2V0LW1hbmFnZXIvdXRpbGl0aWVzLmpzIl0sIm5hbWVzIjpbImRlcGVuZFV0aWwiLCJyZXF1aXJlIiwiaXNTY2VuZSIsImRlY29kZVV1aWQiLCJhc3NldHMiLCJjYWxsSW5OZXh0VGljayIsIk1pc3NpbmdPYmplY3RSZXBvcnRlciIsIkNDX0VESVRPUiIsIkVkaXRvciIsInV0aWxzIiwicHJvY2Vzc09wdGlvbnMiLCJvcHRpb25zIiwidXVpZHMiLCJwYXRocyIsInR5cGVzIiwiYnVuZGxlcyIsImRlcHMiLCJyZWFsRW50cmllcyIsIk9iamVjdCIsImNyZWF0ZSIsImRlYnVnIiwiaSIsImwiLCJsZW5ndGgiLCJpZCIsImVudHJ5IiwidHlwZSIsIm91dCIsInV1aWQiLCJzY2VuZXMiLCJuYW1lIiwicGFja3MiLCJwYWNrSWQiLCJwYWNrZWRJZHMiLCJqIiwidmVyc2lvbnMiLCJmb2xkZXIiLCJlbnRyaWVzIiwicmVkaXJlY3QiLCJjbGVhciIsInRhc2siLCJjbGVhclJlZiIsImlucHV0IiwiaXRlbSIsImlzTmF0aXZlIiwiY29udGVudCIsImRlY1JlZiIsInJlY3ljbGUiLCJ1cmxBcHBlbmRUaW1lc3RhbXAiLCJ1cmwiLCJjYyIsImFzc2V0TWFuYWdlciIsImRvd25sb2FkZXIiLCJhcHBlbmRUaW1lU3RhbXAiLCJ0ZXN0IiwiRGF0ZSIsInJldHJ5IiwicHJvY2VzcyIsInRpbWVzIiwid2FpdCIsIm9uQ29tcGxldGUiLCJpbmRleCIsImVyciIsInJlc3VsdCIsInNldFRpbWVvdXQiLCJnZXREZXBlbmRzIiwiZGF0YSIsImV4Y2x1ZGUiLCJkZXBlbmRzIiwicHJlbG9hZCIsImFzeW5jTG9hZEFzc2V0cyIsImNvbmZpZyIsImluZm8iLCJwYXJzZSIsImluY2x1ZGVOYXRpdmUiLCJBc3NldCIsIl9fbmF0aXZlRGVwZW5kX18iLCJfbmF0aXZlQXNzZXQiLCJwcmV2ZW50RGVmZXJyZWRMb2FkRGVwZW5kZW50cyIsImRlcCIsInB1c2giLCJfX2FzeW5jTG9hZEFzc2V0c19fIiwiYnVuZGxlIiwicHJldmVudFByZWxvYWROYXRpdmVPYmplY3QiLCJuYXRpdmVEZXAiLCJhc3NpZ24iLCJlIiwiY2FjaGUiLCJhc3NldCIsImNhY2hlQXNzZXQiLCJfaXNTY2VuZSIsImFkZCIsInNjZW5lIiwiZXJyb3IiLCJfdXVpZCIsInNldFByb3BlcnRpZXMiLCJhc3NldHNNYXAiLCJtaXNzaW5nQXNzZXQiLCJfX2RlcGVuZHNfXyIsIm1pc3NpbmdBc3NldFJlcG9ydGVyIiwiZGVwZW5kIiwiZGVwZW5kQXNzZXQiLCJzdGFzaEJ5T3duZXIiLCJvd25lciIsInByb3AiLCJzZXJpYWxpemUiLCJhc0Fzc2V0IiwiYWRkUmVmIiwicmVwb3J0QnlPd25lciIsInVuZGVmaW5lZCIsImNvbnNvbGUiLCJnYXRoZXJBc3NldCIsInNvdXJjZSIsIl9fb3V0cHV0QXNBcnJheV9fIiwib3V0cHV0IiwiZm9yRWFjaCIsImFycmF5IiwiY291bnQiLCJlcnJzIiwicGFyc2VQYXJhbWV0ZXJzIiwib25Qcm9ncmVzcyIsImlzQ2FsbGJhY2siLCJwYXJzZUxvYWRSZXNBcmdzIiwiaXNWYWxpZFR5cGUiLCJqcyIsImlzQ2hpbGRDbGFzc09mIiwiY2hlY2tDaXJjbGVSZWZlcmVuY2UiLCJtYXAiLCJjaGVja2VkIiwiZ2V0RGVwcyIsImFzeW5jaWZ5IiwiY2IiLCJwMSIsInAyIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUFBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUF3QkEsSUFBTUEsVUFBVSxHQUFHQyxPQUFPLENBQUMsZUFBRCxDQUExQjs7ZUFDZ0NBLE9BQU8sQ0FBQyxVQUFEO0lBQS9CQyxtQkFBQUE7SUFBU0Msc0JBQUFBOztnQkFDRUYsT0FBTyxDQUFDLFVBQUQ7SUFBbEJHLG1CQUFBQTs7Z0JBQ21CSCxPQUFPLENBQUMsbUJBQUQ7SUFBMUJJLDJCQUFBQTs7QUFDUixJQUFNQyxxQkFBcUIsR0FBR0MsU0FBUyxJ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Q0QsQ0FBQyxFQUF6QyxFQUE2QztBQUN6QyxZQUFJMEQsR0FBRyxHQUFHL0QsSUFBSSxDQUFDSyxDQUFELENBQWQ7O0FBQ0EsWUFBSTBELEdBQUcsS0FBS3dCLEtBQVIsSUFBaUI5RixLQUFLLENBQUNxSCxvQkFBTixDQUEyQnZCLEtBQTNCLEVBQWtDeEIsR0FBbEMsRUFBdUNnRCxHQUF2QyxFQUE0Q0MsT0FBNUMsQ0FBckIsRUFBMkU7QUFDdkVqRSxVQUFBQSxNQUFNLEdBQUcsSUFBVDtBQUNBO0FBQ0g7QUFDSjtBQUNKOztBQUNELFdBQU9BLE1BQVA7QUFDSCxHQTdTTztBQStTUm1FLEVBQUFBLFFBL1NRLG9CQStTRUMsRUEvU0YsRUErU007QUFDVixXQUFPLFVBQVVDLEVBQVYsRUFBY0MsRUFBZCxFQUFrQjtBQUNyQkYsTUFBQUEsRUFBRSxJQUFJOUgsY0FBYyxDQUFDOEgsRUFBRCxFQUFLQyxFQUFMLEVBQVNDLEVBQVQsQ0FBcEI7QUFDSCxLQUZEO0FBR0g7QUFuVE8sQ0FBWjtBQXNUQUMsTUFBTSxDQUFDQyxPQUFQLEdBQWlCOUgsS0FBakIiLCJzb3VyY2VzQ29udGVudCI6WyIvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIENvcHlyaWdodCAoYykgMjAxOSBYaWFtZW4gWWFqaSBTb2Z0d2FyZSBDby4sIEx0ZC5cblxuIGh0dHBzOi8vd3d3LmNvY29zLmNvbS9cblxuIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGVuZ2luZSBzb3VyY2UgY29kZSAodGhlIFwiU29mdHdhcmVcIiksIGEgbGltaXRlZCxcbiAgd29ybGR3aWRlLCByb3lhbHR5LWZyZWUsIG5vbi1hc3NpZ25hYmxlLCByZXZvY2FibGUgYW5kIG5vbi1leGNsdXNpdmUgbGljZW5zZVxuIHRvIHVzZSBDb2NvcyBDcmVhdG9yIHNvbGVseSB0byBkZXZlbG9wIGdhbWVzIG9uIHlvdXIgdGFyZ2V0IHBsYXRmb3Jtcy4gWW91IHNoYWxsXG4gIG5vdCB1c2UgQ29jb3MgQ3JlYXRvciBzb2Z0d2FyZSBmb3IgZGV2ZWxvcGluZyBvdGhlciBzb2Z0d2FyZSBvciB0b29scyB0aGF0J3NcbiAgdXNlZCBmb3IgZGV2ZWxvcGluZyBnYW1lcy4gWW91IGFyZSBub3QgZ3JhbnRlZCB0byBwdWJsaXNoLCBkaXN0cmlidXRlLFxuICBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgQ29jb3MgQ3JlYXRvci5cblxuIFRoZSBzb2Z0d2FyZSBvciB0b29scyBpbiB0aGlzIExpY2Vuc2UgQWdyZWVtZW50IGFyZSBsaWNlbnNlZCwgbm90IHNvbGQuXG4gWGlhbWVuIFlhamkgU29mdHdhcmUgQ28uLCBMdGQuIHJlc2VydmVzIGFsbCByaWdodHMgbm90IGV4cHJlc3NseSBncmFudGVkIHRvIHlvdS5cblxuIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gVEhFIFNPRlRXQVJFLlxuICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5jb25zdCBkZXBlbmRVdGlsID0gcmVxdWlyZSgnLi9kZXBlbmQtdXRpbCcpO1xuY29uc3QgeyBpc1NjZW5lLCBkZWNvZGVVdWlkIH0gPSByZXF1aXJlKCcuL2hlbHBlcicpO1xuY29uc3QgeyBhc3NldHMgfSA9IHJlcXVpcmUoJy4vc2hhcmVkJyk7XG5jb25zdCB7IGNhbGxJbk5leHRUaWNrIH0gPSByZXF1aXJlKCcuLi9wbGF0Zm9ybS91dGlscycpO1xuY29uc3QgTWlzc2luZ09iamVjdFJlcG9ydGVyID0gQ0NfRURJVE9SICYmIEVkaXRvci5yZXF1aXJlKCdhcHA6Ly9lZGl0b3IvcGFnZS9zY2VuZS11dGlscy9taXNzaW5nLW9iamVjdC1yZXBvcnRlcicpO1xucmVxdWlyZSgnLi4vYXNzZXRzL0NDQXNzZXQnKTtcblxudmFyIHV0aWxzID0ge1xuXG4gICAgcHJvY2Vzc09wdGlvbnMgKG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKENDX0VESVRPUikgcmV0dXJuO1xuICAgICAgICB2YXIgdXVpZHMgPSBvcHRpb25zLnV1aWRzO1xuICAgICAgICB2YXIgcGF0aHMgPSBvcHRpb25zLnBhdGhzO1xuICAgICAgICB2YXIgdHlwZXMgPSBvcHRpb25zLnR5cGVzO1xuICAgICAgICB2YXIgYnVuZGxlcyA9IG9wdGlvbnMuZGVwcztcbiAgICAgICAgdmFyIHJlYWxFbnRyaWVzID0gb3B0aW9ucy5wYXRocyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG5cbiAgICAgICAgaWYgKG9wdGlvbnMuZGVidWcgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IHV1aWRzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgICAgIHV1aWRzW2ldID0gZGVjb2RlVXVpZCh1dWlkc1tpXSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZvciAobGV0IGlkIGluIHBhdGhzKSB7XG4gICAgICAgICAgICAgICAgbGV0IGVudHJ5ID0gcGF0aHNbaWRdO1xuICAgICAgICAgICAgICAgIGxldCB0eXBlID0gZW50cnlbMV07XG4gICAgICAgICAgICAgICAgZW50cnlbMV0gPSB0eXBlc1t0eXBlXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBvdXQgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSB1dWlkcy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgICAgICBsZXQgdXVpZCA9IHV1aWRzW2ldO1xuICAgICAgICAgICAgICAgIHV1aWRzW2ldID0gb3V0W3V1aWRdID0gZGVjb2RlVXVpZCh1dWlkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHV1aWRzID0gb3V0O1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChsZXQgaWQgaW4gcGF0aHMpIHtcbiAgICAgICAgICAgIGxldCBlbnRyeSA9IHBhdGhzW2lkXTtcbiAgICAgICAgICAgIHJlYWxFbnRyaWVzW3V1aWRzW2lkXV0gPSBlbnRyeTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBzY2VuZXMgPSBvcHRpb25zLnNjZW5lcztcbiAgICAgICAgZm9yIChsZXQgbmFtZSBpbiBzY2VuZXMpIHtcbiAgICAgICAgICAgIGxldCB1dWlkID0gc2NlbmVzW25hbWVdO1xuICAgICAgICAgICAgc2NlbmVzW25hbWVdID0gdXVpZHNbdXVpZF07XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgcGFja3MgPSBvcHRpb25zLnBhY2tzO1xuICAgICAgICBmb3IgKGxldCBwYWNrSWQgaW4gcGFja3MpIHtcbiAgICAgICAgICAgIGxldCBwYWNrZWRJZHMgPSBwYWNrc1twYWNrSWRdO1xuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBwYWNrZWRJZHMubGVuZ3RoOyArK2opIHtcbiAgICAgICAgICAgICAgICBwYWNrZWRJZHNbal0gPSB1dWlkc1twYWNrZWRJZHNbal1dO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHZlcnNpb25zID0gb3B0aW9ucy52ZXJzaW9ucztcbiAgICAgICAgaWYgKHZlcnNpb25zKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBmb2xkZXIgaW4gdmVyc2lvbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgZW50cmllcyA9IHZlcnNpb25zW2ZvbGRlcl07XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlbnRyaWVzLmxlbmd0aDsgaSArPSAyKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCB1dWlkID0gZW50cmllc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgZW50cmllc1tpXSA9IHV1aWRzW3V1aWRdIHx8IHV1aWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHJlZGlyZWN0ID0gb3B0aW9ucy5yZWRpcmVjdDtcbiAgICAgICAgaWYgKHJlZGlyZWN0KSB7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlZGlyZWN0Lmxlbmd0aDsgaSArPSAyKSB7XG4gICAgICAgICAgICAgICAgcmVkaXJlY3RbaV0gPSB1dWlkc1tyZWRpcmVjdFtpXV07XG4gICAgICAgICAgICAgICAgcmVkaXJlY3RbaSArIDFdID0gYnVuZGxlc1tyZWRpcmVjdFtpICsgMV1dO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICB9LFxuXG4gICAgY2xlYXIgKHRhc2ssIGNsZWFyUmVmKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gdGFzay5pbnB1dC5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gdGFzay5pbnB1dFtpXTtcbiAgICAgICAgICAgIGlmIChjbGVhclJlZikge1xuICAgICAgICAgICAgICAgICFpdGVtLmlzTmF0aXZlICYmIGl0ZW0uY29udGVudCAmJiBpdGVtLmNvbnRlbnQuZGVjUmVmICYmIGl0ZW0uY29udGVudC5kZWNSZWYoZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaXRlbS5yZWN5Y2xlKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGFzay5pbnB1dCA9IG51bGw7XG4gICAgfSxcblxuICAgIHVybEFwcGVuZFRpbWVzdGFtcCAodXJsKSB7XG4gICAgICAgIGlmIChjYy5hc3NldE1hbmFnZXIuZG93bmxvYWRlci5hcHBlbmRUaW1lU3RhbXAgJiYgdHlwZW9mIHVybCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGlmICgvXFw/Ly50ZXN0KHVybCkpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHVybCArICcmX3Q9JyArIChuZXcgRGF0ZSgpIC0gMCk7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgcmV0dXJuIHVybCArICc/X3Q9JyArIChuZXcgRGF0ZSgpIC0gMCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHVybDtcbiAgICB9LFxuXG4gICAgcmV0cnkgKHByb2Nlc3MsIHRpbWVzLCB3YWl0LCBvbkNvbXBsZXRlLCBpbmRleCkge1xuICAgICAgICBpbmRleCA9IGluZGV4IHx8IDA7XG4gICAgICAgIHByb2Nlc3MoaW5kZXgsIGZ1bmN0aW9uIChlcnIsIHJlc3VsdCkge1xuICAgICAgICAgICAgaW5kZXgrKztcbiAgICAgICAgICAgIGlmICghZXJyIHx8IGluZGV4ID4gdGltZXMpIHtcbiAgICAgICAgICAgICAgICBvbkNvbXBsZXRlICYmIG9uQ29tcGxldGUoZXJyLCByZXN1bHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHV0aWxzLnJldHJ5KHByb2Nlc3MsIHRpbWVzLCB3YWl0LCBvbkNvbXBsZXRlLCBpbmRleCk7XG4gICAgICAgICAgICAgICAgfSwgd2FpdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBnZXREZXBlbmRzICh1dWlkLCBkYXRhLCBleGNsdWRlLCBkZXBlbmRzLCBwcmVsb2FkLCBhc3luY0xvYWRBc3NldHMsIGNvbmZpZykge1xuICAgICAgICB2YXIgZXJyID0gbnVsbDtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBpbmZvID0gZGVwZW5kVXRpbC5wYXJzZSh1dWlkLCBkYXRhKTtcbiAgICAgICAgICAgIHZhciBpbmNsdWRlTmF0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIGlmIChkYXRhIGluc3RhbmNlb2YgY2MuQXNzZXQgJiYgKCFkYXRhLl9fbmF0aXZlRGVwZW5kX18gfHwgZGF0YS5fbmF0aXZlQXNzZXQpKSBpbmNsdWRlTmF0aXZlID0gZmFsc2U7IFxuICAgICAgICAgICAgaWYgKCFwcmVsb2FkKSB7XG4gICAgICAgICAgICAgICAgYXN5bmNMb2FkQXNzZXRzID0gIUNDX0VESVRPUiAmJiAoISFkYXRhLmFzeW5jTG9hZEFzc2V0cyB8fCAoYXN5bmNMb2FkQXNzZXRzICYmICFpbmZvLnByZXZlbnREZWZlcnJlZExvYWREZXBlbmRlbnRzKSk7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBpbmZvLmRlcHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBkZXAgPSBpbmZvLmRlcHNbaV07XG4gICAgICAgICAgICAgICAgICAgIGlmICghKGRlcCBpbiBleGNsdWRlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXhjbHVkZVtkZXBdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlcGVuZHMucHVzaCh7dXVpZDogZGVwLCBfX2FzeW5jTG9hZEFzc2V0c19fOiBhc3luY0xvYWRBc3NldHMsIGJ1bmRsZTogY29uZmlnICYmIGNvbmZpZy5uYW1lfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoaW5jbHVkZU5hdGl2ZSAmJiAhYXN5bmNMb2FkQXNzZXRzICYmICFpbmZvLnByZXZlbnRQcmVsb2FkTmF0aXZlT2JqZWN0ICYmIGluZm8ubmF0aXZlRGVwKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZyAmJiAoaW5mby5uYXRpdmVEZXAuYnVuZGxlID0gY29uZmlnLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICBkZXBlbmRzLnB1c2goT2JqZWN0LmFzc2lnbih7fSwgaW5mby5uYXRpdmVEZXApKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBsID0gaW5mby5kZXBzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBsZXQgZGVwID0gaW5mby5kZXBzW2ldO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIShkZXAgaW4gZXhjbHVkZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVbZGVwXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZXBlbmRzLnB1c2goe3V1aWQ6IGRlcCwgYnVuZGxlOiBjb25maWcgJiYgY29uZmlnLm5hbWV9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoaW5jbHVkZU5hdGl2ZSAmJiBpbmZvLm5hdGl2ZURlcCkge1xuICAgICAgICAgICAgICAgICAgICBjb25maWcgJiYgKGluZm8ubmF0aXZlRGVwLmJ1bmRsZSA9IGNvbmZpZy5uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgZGVwZW5kcy5wdXNoKE9iamVjdC5hc3NpZ24oe30sIGluZm8ubmF0aXZlRGVwKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICBlcnIgPSBlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBlcnI7XG4gICAgfSxcbiAgICBcbiAgICBjYWNoZSAoaWQsIGFzc2V0LCBjYWNoZUFzc2V0KSB7XG4gICAgICAgIGlmICghYXNzZXQpIHJldHVybjtcbiAgICAgICAgdmFyIF9pc1NjZW5lID0gaXNTY2VuZShhc3NldCk7XG4gICAgICAgIGlmICghX2lzU2NlbmUgJiYgY2FjaGVBc3NldCkge1xuICAgICAgICAgICAgYXNzZXRzLmFkZChpZCwgYXNzZXQpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChfaXNTY2VuZSkge1xuICAgICAgICAgICAgaWYgKENDX0VESVRPUiAmJiAhYXNzZXQuc2NlbmUpIHtcbiAgICAgICAgICAgICAgICBFZGl0b3IuZXJyb3IoJ1NvcnJ5LCB0aGUgc2NlbmUgZGF0YSBvZiBcIiVzXCIgaXMgY29ycnVwdGVkIScsIGFzc2V0Ll91dWlkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBzZXRQcm9wZXJ0aWVzICh1dWlkLCBhc3NldCwgYXNzZXRzTWFwKSB7XG5cbiAgICAgICAgdmFyIG1pc3NpbmdBc3NldCA9IGZhbHNlO1xuICAgICAgICBsZXQgZGVwZW5kcyA9IGFzc2V0Ll9fZGVwZW5kc19fO1xuICAgICAgICBpZiAoZGVwZW5kcykge1xuICAgICAgICAgICAgdmFyIG1pc3NpbmdBc3NldFJlcG9ydGVyID0gbnVsbDtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gZGVwZW5kcy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVwZW5kID0gZGVwZW5kc1tpXTtcbiAgICAgICAgICAgICAgICB2YXIgZGVwZW5kQXNzZXQgPSBhc3NldHNNYXBbZGVwZW5kLnV1aWQgKyAnQGltcG9ydCddO1xuICAgICAgICAgICAgICAgIGlmICghZGVwZW5kQXNzZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKENDX0VESVRPUikge1xuICAgICAgICAgICAgICAgICAgICAgICAgIW1pc3NpbmdBc3NldFJlcG9ydGVyICYmIChtaXNzaW5nQXNzZXRSZXBvcnRlciA9IG5ldyBNaXNzaW5nT2JqZWN0UmVwb3J0ZXIoYXNzZXQpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1pc3NpbmdBc3NldFJlcG9ydGVyLnN0YXNoQnlPd25lcihkZXBlbmQub3duZXIsIGRlcGVuZC5wcm9wLCBFZGl0b3Iuc2VyaWFsaXplLmFzQXNzZXQoZGVwZW5kLnV1aWQpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNjLmVycm9yKCdUaGUgYXNzZXQgJyArIGRlcGVuZC51dWlkICsgJyBpcyBtaXNzaW5nIScpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIG1pc3NpbmdBc3NldCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBkZXBlbmQub3duZXJbZGVwZW5kLnByb3BdID0gZGVwZW5kQXNzZXQuYWRkUmVmKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBtaXNzaW5nQXNzZXRSZXBvcnRlciAmJiBtaXNzaW5nQXNzZXRSZXBvcnRlci5yZXBvcnRCeU93bmVyKCk7XG4gICAgICAgICAgICBhc3NldC5fX2RlcGVuZHNfXyA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKGFzc2V0Ll9fbmF0aXZlRGVwZW5kX18pIHtcbiAgICAgICAgICAgIGlmICghYXNzZXQuX25hdGl2ZUFzc2V0KSB7XG4gICAgICAgICAgICAgICAgaWYgKGFzc2V0c01hcFt1dWlkICsgJ0BuYXRpdmUnXSkge1xuICAgICAgICAgICAgICAgICAgICBhc3NldC5fbmF0aXZlQXNzZXQgPSBhc3NldHNNYXBbdXVpZCArICdAbmF0aXZlJ107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBtaXNzaW5nQXNzZXQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBpZiAoQ0NfRURJVE9SKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGB0aGUgbmF0aXZlIGFzc2V0IG9mICR7dXVpZH0gaXMgbWlzc2luZyFgKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFzc2V0Ll9fbmF0aXZlRGVwZW5kX18gPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG1pc3NpbmdBc3NldDtcbiAgICB9LFxuXG4gICAgZ2F0aGVyQXNzZXQgKHRhc2spIHtcbiAgICAgICAgbGV0IHNvdXJjZSA9IHRhc2suc291cmNlO1xuICAgICAgICBpZiAoIXRhc2sub3B0aW9ucy5fX291dHB1dEFzQXJyYXlfXyAmJiBzb3VyY2UubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICB0YXNrLm91dHB1dCA9IHNvdXJjZVswXS5jb250ZW50O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbGV0IG91dHB1dCA9IHRhc2sub3V0cHV0ID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IHNvdXJjZS5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgICAgICBvdXRwdXQucHVzaChzb3VyY2VbaV0uY29udGVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgZm9yRWFjaCAoYXJyYXksIHByb2Nlc3MsIG9uQ29tcGxldGUpIHtcbiAgICAgICAgdmFyIGNvdW50ID0gMDtcbiAgICAgICAgdmFyIGVycnMgPSBbXTtcbiAgICAgICAgaWYgKGFycmF5Lmxlbmd0aCA9PT0gMCkgb25Db21wbGV0ZSAmJiBvbkNvbXBsZXRlKGVycnMpO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGFycmF5Lmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgcHJvY2VzcyhhcnJheVtpXSwgZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgZXJycy5wdXNoKGVycik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvdW50ICsrO1xuICAgICAgICAgICAgICAgIGlmIChjb3VudCA9PT0gbCkge1xuICAgICAgICAgICAgICAgICAgICBvbkNvbXBsZXRlICYmIG9uQ29tcGxldGUoZXJycyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgcGFyc2VQYXJhbWV0ZXJzIChvcHRpb25zLCBvblByb2dyZXNzLCBvbkNvbXBsZXRlKSB7XG4gICAgICAgIGlmIChvbkNvbXBsZXRlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBpc0NhbGxiYWNrID0gdHlwZW9mIG9wdGlvbnMgPT09ICdmdW5jdGlvbic7XG4gICAgICAgICAgICBpZiAob25Qcm9ncmVzcykge1xuICAgICAgICAgICAgICAgIG9uQ29tcGxldGUgPSBvblByb2dyZXNzO1xuICAgICAgICAgICAgICAgIGlmICghaXNDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICBvblByb2dyZXNzID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChvblByb2dyZXNzID09PSB1bmRlZmluZWQgJiYgaXNDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIG9uQ29tcGxldGUgPSBvcHRpb25zO1xuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSBudWxsO1xuICAgICAgICAgICAgICAgIG9uUHJvZ3Jlc3MgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9uUHJvZ3Jlc3MgIT09IHVuZGVmaW5lZCAmJiBpc0NhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgb25Qcm9ncmVzcyA9IG9wdGlvbnM7XG4gICAgICAgICAgICAgICAgb3B0aW9ucyA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwgT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICAgICAgcmV0dXJuIHsgb3B0aW9ucywgb25Qcm9ncmVzcywgb25Db21wbGV0ZSB9O1xuICAgIH0sXG5cbiAgICBwYXJzZUxvYWRSZXNBcmdzICh0eXBlLCBvblByb2dyZXNzLCBvbkNvbXBsZXRlKSB7XG4gICAgICAgIGlmIChvbkNvbXBsZXRlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBpc1ZhbGlkVHlwZSA9IGNjLmpzLmlzQ2hpbGRDbGFzc09mKHR5cGUsIGNjLkFzc2V0KTtcbiAgICAgICAgICAgIGlmIChvblByb2dyZXNzKSB7XG4gICAgICAgICAgICAgICAgb25Db21wbGV0ZSA9IG9uUHJvZ3Jlc3M7XG4gICAgICAgICAgICAgICAgaWYgKGlzVmFsaWRUeXBlKSB7XG4gICAgICAgICAgICAgICAgICAgIG9uUHJvZ3Jlc3MgPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG9uUHJvZ3Jlc3MgPT09IHVuZGVmaW5lZCAmJiAhaXNWYWxpZFR5cGUpIHtcbiAgICAgICAgICAgICAgICBvbkNvbXBsZXRlID0gdHlwZTtcbiAgICAgICAgICAgICAgICBvblByb2dyZXNzID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0eXBlID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvblByb2dyZXNzICE9PSB1bmRlZmluZWQgJiYgIWlzVmFsaWRUeXBlKSB7XG4gICAgICAgICAgICAgICAgb25Qcm9ncmVzcyA9IHR5cGU7XG4gICAgICAgICAgICAgICAgdHlwZSA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgdHlwZSwgb25Qcm9ncmVzcywgb25Db21wbGV0ZSB9O1xuICAgIH0sXG5cbiAgICBjaGVja0NpcmNsZVJlZmVyZW5jZSAob3duZXIsIHV1aWQsIG1hcCwgY2hlY2tlZCkge1xuICAgICAgICBpZiAoIWNoZWNrZWQpIHsgXG4gICAgICAgICAgICBjaGVja2VkID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgaXRlbSA9IG1hcFt1dWlkXTtcbiAgICAgICAgaWYgKCFpdGVtIHx8IGNoZWNrZWRbdXVpZF0pIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBjaGVja2VkW3V1aWRdID0gdHJ1ZTtcbiAgICAgICAgdmFyIHJlc3VsdCA9IGZhbHNlO1xuICAgICAgICB2YXIgZGVwcyA9IGRlcGVuZFV0aWwuZ2V0RGVwcyh1dWlkKTtcbiAgICAgICAgaWYgKGRlcHMpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gZGVwcy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVwID0gZGVwc1tpXTtcbiAgICAgICAgICAgICAgICBpZiAoZGVwID09PSBvd25lciB8fCB1dGlscy5jaGVja0NpcmNsZVJlZmVyZW5jZShvd25lciwgZGVwLCBtYXAsIGNoZWNrZWQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0sXG5cbiAgICBhc3luY2lmeSAoY2IpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChwMSwgcDIpIHtcbiAgICAgICAgICAgIGNiICYmIGNhbGxJbk5leHRUaWNrKGNiLCBwMSwgcDIpO1xuICAgICAgICB9XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSB1dGlsczsiXSwic291cmNlUm9vdCI6Ii8ifQ==