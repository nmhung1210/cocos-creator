"use strict";const e=require("fire-fs"),i=Editor.require("packages://huawei-agc/const.js"),t=require("electron").remote.dialog,r=require(Editor.url("packages://builder/panel/platform/android.js"));let s=Editor.Profile.load(i.PROFILE_PATH);const n=require("electron").ipcRenderer,c={id:"0",name:Editor.T("huawei-agc.empty_plugin_name"),plugins:[]},o="3";let a=r.template;exports.name="huawei-agc",exports.mixins=[r],exports.data=function(){return{selected:null,config:[]}},exports.computed={currentSelect(){if(this.selected)for(let e in this.config)if(this.config[e].id===this.selected)return this.config[e];return null}},exports.methods={t:e=>Editor.T(`huawei-agc.${e}`),jumpClick(){Editor.Panel.open("cocos-services")},parseConfig(e){return this.paramValid(e)?this.t("plugin_config"):this.t("plugin_not_config")},paramValid:e=>e.hasParam,checkParams(){if(!this.currentSelect)return!1;if("0"===this.currentSelect.id)return!0;if(this.currentSelect.plugins.find(e=>e.requireParam&&!e.hasParam))return t.showErrorBox(this.t("param_empty_title"),this.t("param_empty_desc")),!1;return!0},queryDisplayName(e){Editor.Ipc.sendToMain("cocos-services:plugin-messages","sdkhub:plugins-type",e.id,(i,t)=>{if(!i&&t)for(let i in t){let r=t[i],s=e.plugins.find(e=>e.pId===i);s&&(s.pName+=r)}})},loadConfig(){if(e.existsSync(i.CONFIG_PATH)){let t=e.readJsonSync(i.CONFIG_PATH,"utf8").configSet;(t=t.filter(e=>e.platform===o)).forEach(e=>{this.queryDisplayName(e)}),this.config=t}this.config.unshift(c),this.selected=this.checkConfigExists()?s.get("configSelected"):this.config.length>0?this.config[0].id:null},checkConfigExists(){let e=s.get("configSelected");return!!this.config.find(i=>i.id===e)}},exports.created=function(){n.on("huawei-agc:update-sdkhub-config",(e,...i)=>{this.loadConfig()}),this.loadConfig()},exports.watch={selected(e){s.set("configSelected",e),s.save()}},exports.template=a+e.readFileSync(Editor.url("packages://huawei-agc/ui/index.html"),"utf8");