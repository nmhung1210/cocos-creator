"use strict";require("../utils");const e=require("./clip");let i={},n=[],u=null,t=function(e){-1===n.indexOf(e)&&n.push(e),clearTimeout(u),u=setTimeout(()=>{for(;n.length;){let e=n.pop(),u=i[e];u&&Editor.Ipc.sendToPanel("scene","scene:animation-clip-changed",{uuid:u._uuid,clip:u.name,data:u.serialize(),dirty:!0})}},250)};module.exports={register:function(e){return i[e._uuid]?null:i[e._uuid]=e},unregister:function(e){return i[e._uuid]?(delete i[e._uuid],e):null},clear:function(){Object.keys(i).forEach(e=>{delete i[e]})},sync:t,isExists:function(e){return!!i[e]},equal:function(e,n){let u=i[e];return!!u&&Editor.serialize(u)===Editor.serialize(n)},Clip:e,Undo:null},Object.keys(e).forEach(n=>{let u=e[n];0===n.indexOf("query")?e[n]=function(e,...n){return t(e),u(i[e],...n)}:e[n]=function(e,...n){return u(i[e],...n)}});