require("./utils");const e=require("../camera");module.exports={onMouseUp(c){if(1===c.which){let t=c.offsetX,n=cc.game.canvas.height-c.offsetY,o=cc.engine.getInstanceById(cc.engine.editingRootNode);o||(o=cc.director.getScene());let i=e._camera.getRay(cc.v3(t,n,1)),r=cc.geomUtils.intersect.raycast(cc.director.getScene(),i,function(e,c,t){let n=c.getComponent(cc.MeshRenderer);return n&&n.mesh?cc.geomUtils.intersect.rayMesh(e,n.mesh):t},function(e){return!(e.getComponent(cc.Canvas)||e._objFlags&(cc.Object.Flags.LockedInEditor|cc.Object.Flags.HideInHierarchy))}),d=!1,s=Editor.Selection.curSelection("node");if((c.metaKey||c.ctrlKey)&&(d=!0),r.length>0){let e=r[0].node;e&&(d?-1===s.indexOf(e.uuid)?Editor.Selection.select("node",e.uuid,!1,!0):Editor.Selection.unselect("node",e.uuid,!0):Editor.Selection.select("node",e.uuid,!0,!0))}else Editor.Selection.clear("node")}}};