"use strict";const r=require("fire-fs"),e=require("fire-path"),n=require("async"),o=require("decompress"),t=require("child_process").spawn;exports.remove=function(o,t){r.readdir(o,function(i,s){if(i)return t(i);n.eachSeries(s,function(n,t){var i=e.join(o,n),s=r.statSync(i);setTimeout(function(){s.isDirectory()?exports.remove(i,function(e){e?t(e):r.remove(i,t)}):r.remove(i,t)},20)},function(e){setTimeout(function(){e?t(e):r.remove(o,t)},20)})})},exports.copy=function(e,n,o){try{r.copySync(e,n)}catch(r){return o&&o(r),void 0}o&&o(null)};"darwin"===process.platform?exports.unzip=function(n,o,i){var s=e.dirname(o);r.ensureDirSync(s);var c=t("unzip",[n,"-d",o]),a="";c.stderr.on("data",r=>{a+=r});var u="";c.stdout.on("data",r=>{u+=r}),c.on("close",r=>{u&&console.log(u),a&&Editor.warn(a);var e=null;0!==r&&(e=new Error("The decompression has failed")),i(e)})}:"win32"===process.platform?exports.unzip=function(n,o,i){var s=e.dirname(o);r.ensureDirSync(s);var c=t(Editor.url("unpack://static/tools/unzip.exe"),[n,"-d",o]),a="";c.stderr.on("data",r=>{a+=r});var u="";c.stdout.on("data",r=>{u+=r}),c.on("close",r=>{u&&console.log(u),a&&Editor.warn(a);var e=null;0!==r&&(e=new Error("The decompression has failed")),i(e)})}:exports.unzip=function(r,e,n){o(r,e).then(function(){n()}).catch(function(r){n(r)})};