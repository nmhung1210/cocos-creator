"use strict";const e=require("../../console"),t=require("../utils/dock-utils"),a=require("../utils/focus-mgr"),r=require("../utils/drag-drop"),i=require("./dock"),s=require("../../ipc");module.exports=class extends i{static get tagName(){return"UI-MAIN-DOCK"}createdCallback(){super.createdCallback(),this.noCollapse=!0,this._initEvents(),t.root=this,this._loadLayout(t=>{t&&e.error(`Failed to load layout: ${t.stack}`),a._setFocusPanelFrame(null)})}_finalizeStyle(){super._finalizeStyle(),this.style.minWidth="",this.style.minHeight=""}_initEvents(){this.addEventListener("dragenter",e=>{"tab"===r.type(e.dataTransfer)&&(e.stopPropagation(),t.dragenterMainDock())}),this.addEventListener("dragleave",e=>{"tab"===r.type(e.dataTransfer)&&(e.stopPropagation(),t.dragleaveMainDock())}),this.addEventListener("dragover",e=>{"tab"===r.type(e.dataTransfer)&&(e.preventDefault(),e.stopPropagation(),r.updateDropEffect(e.dataTransfer,"move"),t.dragoverMainDock(e.x,e.y))}),this.addEventListener("drop",e=>{if("tab"!==r.type(e.dataTransfer))return;e.preventDefault(),e.stopPropagation();let a=r.items(e.dataTransfer)[0];t.dropMainDock(a)})}_loadLayout(e){s.sendToMain("editor:window-query-layout",(a,r)=>{if(a)return e&&e(a),void 0;t.reset(this,r,t=>{e&&e(t)})})}};